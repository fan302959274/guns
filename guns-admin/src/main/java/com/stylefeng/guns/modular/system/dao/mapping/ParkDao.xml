<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stylefeng.guns.modular.system.dao.ParkDao">

    <sql id="Base_Column_List">
        a.id, pkname  , prov, city, pkdesc, pkaddr,businesstime,createdate,updatedate,cost
    </sql>

    <select id="selectParks" resultType="map">
        select
        <include refid="Base_Column_List" />,
        (
        CASE
        WHEN (status = 0 OR status IS NULL) THEN
        '正常使用'
        ELSE
        '禁用'
        END
        ) "status",
        (
        CASE
        WHEN a.area = 1 THEN
        '城南'
        ELSE
        '城北'
        END
        ) "area"
        from pk_park a
        LEFT  JOIN  areas  b  ON   a.area =b.areaid
        <if test="parkname != null">
            where pkname like CONCAT('%',#{parkname},'%')
        </if>
        ORDER  by a.id DESC
    </select>

    <update id="setStatus">
        update pk_park set status = #{status} where id =
        #{parkId}
    </update>

    <select id="selectParksRelation" resultType="map">
        select
       id, parkid,week,end,start
        from pk_park_relation
        where 1=1
        <if test="parkId != null">
         AND  parkid = ${parkId}
        </if>
    </select>


</mapper>